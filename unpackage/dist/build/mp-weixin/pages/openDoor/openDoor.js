"use strict";const o=require("../../common/vendor.js"),t=require("../../utils/check.js"),e={components:{CustomModal:()=>"../../component/custom-modal/custom-modal.js"},data:()=>({isOpen:getApp().globalData.isOP,inner:getApp().globalData.in,operator:"图灵管理员",showModal:!1}),methods:{showCustomModal(){this.showModal=!0},handleConfirm(o){t.register(o.name,o.className),this.showModal=!1},handleClose(){this.showModal=!1},getLabStatus(){o.index.request({url:"https://turingteam.xyz:9642/getLabStatus",method:"GET",success:o=>{200===o.data.code&&(this.operator=o.data.data.operator)},fail:o=>{console.log(o)}})},open(){""!=o.index.getStorageSync("token")?this.openDoor():t.login(this.openDoor,this.showCustomModal)},openDoor(){const e=o.index.getStorageSync("token");o.index.request({url:"https://turingteam.xyz:9642/openLab",method:"PUT",header:{Authorization:e},success:e=>{console.log(e),200===e.data.code?(this.isOpen=e.data.data.status,this.operator=e.data.data.operator,getApp().globalData.isOP=e.data.data.status,o.index.showToast({title:"开门成功",icon:"success",mask:!0})):403===e.data.code&&t.login(this.openDoor,this.showCustomModal)},fail:t=>{console.log(t),o.index.showToast({title:"开门失败",icon:"fail"})}}),setTimeout((()=>{o.index.switchTab({url:"/pages/index/index"})}),1500)},close(){if(""==o.index.getStorageSync("token"))return console.log("未登录"),void t.login(this.closeDoor,this.showCustomModal);this.closeDoor()},closeDoor(){const e=o.index.getStorageSync("token");o.index.request({url:"https://turingclock.raqtpie.xyz:9642/closeLab",method:"PUT",header:{Authorization:e},success:e=>{console.log(e),200===e.data.code?(this.isOpen=e.data.data.status,this.operator=e.data.data.operator,getApp().globalData.isOP=e.data.data.status,o.index.showToast({title:"关门成功",icon:"success",mask:!0})):403===e.data.code&&t.login(this.closeDoor,this.showCustomModal)},fail:t=>{console.log(t),o.index.showToast({title:"关门失败",icon:"fail"})}}),setTimeout((()=>{o.index.switchTab({url:"/pages/index/index"})}),1500)}},onShow(){this.getLabStatus()}};if(!Array){o.resolveComponent("CustomModal")()}const s=o._export_sfc(e,[["render",function(t,e,s,a,n,i){return o.e({a:n.isOpen},n.isOpen?{b:o.t(n.operator)}:{},{c:!n.isOpen},n.isOpen?{}:{d:o.t(n.operator)},{e:!n.inner},(n.inner,{}),{f:n.isOpen},n.isOpen?{g:!n.inner,h:o.o(((...o)=>i.close&&i.close(...o)))}:{},{i:!n.isOpen},n.isOpen?{}:{j:!n.inner,k:o.o(((...o)=>i.open&&i.open(...o)))},{l:o.o(i.handleConfirm),m:o.o(i.handleClose),n:n.showModal})}]]);wx.createPage(s);
