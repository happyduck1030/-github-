"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/check.js"),o=require("../../common/assets.js"),s={components:{CustomModal:()=>"../../component/custom-modal/custom-modal.js"},data:()=>({yesterdayRecord:[],personalRecord:[],todayTime:0,totalTime:0,name:"",className:"",showModal:!1}),methods:{showCustomModal(){this.showModal=!0},handleConfirm(e){t.register(e.name,e.className),this.showModal=!1},handleClose(){this.showModal=!1},showPersonalRecord(){if(""==e.index.getStorageSync("token"))return console.log("未登录"),void t.login(this.getPersonalRecord,this.showCustomModal);this.getPersonalRecord()},getUserInfo(){const o=e.index.getStorageSync("token");""!=o&&e.index.request({url:"https://turingteam.xyz:9642/getUserInfo",method:"GET",header:{Authorization:o},success:e=>{200===e.data.code?(this.name=e.data.data.name,this.className=e.data.data.className):403===e.data.code&&t.login(this.getUserInfo,this.showCustomModal)},fail:e=>{console.log(e)}})},getYesterdayRecord(){e.index.request({url:"https://turingteam.xyz:9642/getRecordYesterday",method:"GET",success:e=>{200===e.data.code&&(this.yesterdayRecord=e.data.data)}})},getPersonalTotalTime(){const o=e.index.getStorageSync("token");""!=o&&e.index.request({url:"https://turingteam.xyz:9642/getTotalTimeByUserId",method:"GET",header:{Authorization:o},success:e=>{200===e.data.code?this.totalTime=e.data.data.totalTime:403===e.data.code&&t.login(this.getPersonalTotalTime,this.showCustomModal)},fail:e=>{console.log(e)}})},getPersonalRecord(){const o=e.index.getStorageSync("token");""!=o&&e.index.request({url:"https://turingteam.xyz:9642/getRecordByUserId",method:"GET",header:{Authorization:o},success:e=>{200===e.data.code?this.personalRecord=e.data.data:403===e.data.code&&t.login(this.getPersonalRecord,this.showCustomModal)},fail:e=>{console.log(e)}})},getTodayRecord(){const o=e.index.getStorageSync("token");""!=o&&e.index.request({url:"https://turingteam.xyz:9642/getTotalTimeByUserIdToday",method:"GET",header:{Authorization:o},success:e=>{200===e.data.code?this.todayTime=e.data.data.totalTime:403===e.data.code&&t.login(this.getTodayRecord,this.showCustomModal)},fail:e=>{console.log(e)}})}},onShow(){this.getYesterdayRecord(),this.getTodayRecord(),this.getPersonalRecord(),this.getPersonalTotalTime(),this.getUserInfo()},onPullDownRefresh(){this.getYesterdayRecord(),this.getTodayRecord(),this.getPersonalRecord(),this.getPersonalTotalTime(),this.getUserInfo(),setTimeout((()=>{e.index.stopPullDownRefresh()}),1e3)}};if(!Array){(e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("CustomModal"))()}Math||((()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js"))();const a=e._export_sfc(s,[["render",function(t,s,a,d,r,n){return e.e({a:e.p({title:"总排名",showArrow:!0,link:"navigateTo",to:"../rank/rank"}),b:e.p({border:!1}),c:0==r.yesterdayRecord.length},0==r.yesterdayRecord.length?{}:{d:e.f(r.yesterdayRecord.slice(0,4),((t,o,s)=>({a:e.t(t.username),b:e.t(t.totalTime),c:o})))},{e:o._imports_0$1,f:e.t(r.todayTime),g:e.p({border:!1}),h:e.t(""!=r.name&&""!=r.className?r.name+" | "+r.className:"历史记录"),i:""!=r.name&&""!=r.className},(""!=r.name&&r.className,{}),{j:e.t(r.totalTime),k:e.p({border:!1}),l:0==r.personalRecord.length},0==r.personalRecord.length?{m:o._imports_0,n:e.o(((...e)=>n.showPersonalRecord&&n.showPersonalRecord(...e)))}:{o:e.f(r.personalRecord,((t,o,s)=>({a:e.t(t.chairId),b:e.t(t.date),c:e.t(t.time),d:o,e:"50e3fded-7-"+s+",50e3fded-6"})))},{p:e.o(n.handleConfirm),q:e.o(n.handleClose),r:r.showModal})}]]);wx.createPage(a);
